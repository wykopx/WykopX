/* 
	----- Zapraszam na tag #wykopx -----

	TEN SKRYPT SÅUÅ»Y DO WYCZYSZCZENIA LISTY OBSERWOWANYCH DYSKUSJI
	JeÅ›li nie wiesz jak z niego skorzystaÄ‡, przeczytaj instrukcjÄ™ poniÅ¼ej.

	UWAGA! TEN SKRYPT NIE JEST SKRYPTEM DO ViolentMonkey/TamperMonkey
	KOD TEGO SKRYPTU NALEÅ»Y WKLEIÄ† GO DO KONSOLI [CTRL + SHIFT + C]	

	INSTRUKCJA:
	1. wejdÅº na dowolnÄ… stronÄ™ wykop.pl

	2. otwÃ³rz konsolÄ™ skrÃ³tem [CTRL + SHIFT + C] lub klawiszem [F12]

	3. wpisz w konsoli `allow-pasting` (razem z cudzysÅ‚owami ` `) i wciÅ›nij [ENTER]

	4. wklej CAÅY poniÅ¼szy kod i wciÅ›nij [ENTER]

	5. Na gÃ³rnej belce Wykopu pojawi siÄ™ nowy przycisk, ktÃ³ry po klikniÄ™ciu:

		- sprawdzi ile dyskusji obserwujesz
		- w kilku krokach pozwoli ci wybraÄ‡ czy chcesz usunÄ…Ä‡ obserwowane wpisy/znaleziska/komentarze
		- zdecydujesz czy chcesz rÃ³wnieÅ¼ usuwaÄ‡ dyskusje, ktÃ³re dodaÅ‚eÅ› do Ulubionych
		(jeÅ›li chcesz, aby niektÃ³re obserwowane dyskusje nie byÅ‚y usuniÄ™te - dodaj je wczeÅ›niej do ulubionych)
		- w ostatnim kroku masz moÅ¼liwoÅ›Ä‡ rezygnacji - nic nie zostanie wtedy usuniÄ™te

		- w trakcie usuwania pasek postÄ™pu pokazywany jest w adresie URL na przykÅ‚ad:
		https://wykop.pl/tag/wykopx/#--usuniÄ™to: 178/180 (99%)


	Lista dyskusji, ktÃ³re obserwujesz znajduje siÄ™ tutaj:
	https://wykop.pl/obserwowane/dyskusje

	Wersja zminimalizowana tego skryptu gotowa do wklejenia= w konsoli:
	https://raw.githubusercontent.com/wykopx/WykopX/refs/heads/main/Wykop%20XS%20-%20skrypty%20do%20konsoli/wykop_xs_czyszczenie_listy_obserwowanych_dyskusji.min.js

	PeÅ‚na wersja tego skryptu tutaj:
	https://github.com/wykopx/WykopX/blob/main/Wykop%20XS%20-%20skrypty%20do%20konsoli/wykop_xs_czyszczenie_listy_obserwowanych_dyskusji.js

	Chcesz wesprzeÄ‡ projekt Wykop X? Postaw kawÄ™:

	@contributionURL				https://buycoffee.to/wykopx

	@author							Wykop X <wykopx@gmail.com>
	@License						No License
	@version						1.0.2

	----- Zapraszam na tag #wykopx -----
*/
let observedLinks = 0, observedLinksFavourited = 0, observedEntries = 0, observedEntriesFavourited = 0, observedLinkComments = 0, observedLinkCommentsFavourited = 0, deleteEntries = !0, deleteLinks = !0, deleteLinkComments = !0, dontDeleteFavourites = !0, totalToDelete = 0; async function fetchObservedDiscussionData() { const e = localStorage.getItem("token"); if (!e) return new Map; const o = new Map; async function n(n = "") { const t = "https://wykop.pl/api/v3/observed/discussions" + (n ? `?page=${n}` : ""), s = await fetch(t, { headers: { Authorization: `Bearer ${e}` } }); if (!s.ok) return null; const i = await s.json(); return i.data.forEach((e => { o.set(e.object.id, e), "entry" == e.object.resource ? (observedEntries++, e.object.favourite && observedEntriesFavourited++) : "link" == e.object.resource ? (observedLinks++, e.object.favourite && observedLinksFavourited++) : "link_comment" == e.object.resource && (observedLinkComments++, e.object.favourite && observedLinkCommentsFavourited++) })), i.pagination.next } let t = await n(); for (let e = 0; t; e++)t = await n(t), await delay(100); return o } function delay(e) { return new Promise((o => setTimeout(o, e))) } async function deleteSelectedFromMap(e) { const o = localStorage.getItem("token"); if (!o) return; const n = new URL(window.location.href); n.pathname = "/tag/wykopx", window.history.pushState({}, "", n); let t = 0; for (const [n, s] of e) { let e = ""; if ("entry" == s.object.resource && deleteEntries ? e = `https://wykop.pl/api/v3/entries/${s.object.id}/observed-discussions` : "link" == s.object.resource && deleteLinks ? e = `https://wykop.pl/api/v3/links/${s.object.id}/observed-discussions` : "link_comment" == s.object.resource && deleteLinkComments && (e = `https://wykop.pl/api/v3/links/${s.object.parent.id}/comments/${s.object.id}/observed-discussions`), s.object.favourite && dontDeleteFavourites && (e = ""), "" !== e) { t++; await fetch(e, { method: "DELETE", headers: { Authorization: `Bearer ${o}` } }); await delay(170) } 0; const n = `--usunieto:${t}/${totalToDelete}_(${Math.ceil(100 * t / totalToDelete)}%)`; window.location.hash = n } } async function wykopx() { observedLinks = 0, observedLinksFavourited = 0, observedEntries = 0, observedEntriesFavourited = 0, observedLinkComments = 0, observedLinkCommentsFavourited = 0, deleteEntries = !1, deleteLinks = !1, deleteLinkComments = !1, dontDeleteFavourites = !0, totalToDelete = 0; let e = 0, o = 7; alert(`KROK ${++e}/7\nWykop X przeanalizuje teraz obserwowane przez Ciebie dyskusje \n\n> Kliknij [OK] i poczekaj kilka sekund.\n\nSpokojnie, jeszcze nie usuwamy obserwowanych dyskusji.\nPrzejdziemy do tego w nastÄ™pnych krokach.`), fetchObservedDiscussionData().then((n => { if (0 === n.size) o = 1, alert(`KROK ${++e}/${o}\n\nWykop X przeanalizowaÅ‚ Twoje obserwowane:\n- Nie obserwujesz Å¼adnych dyskusji`); else { 0 == observedEntries && o--, 0 == observedLinks && o--, 0 == observedLinkComments && o--, alert(`KROK ${++e}/${o}\n- Obserwujesz Å‚Ä…cznie: (${n.size}) dyskusji\n- Limit obserwowanych dyskusji na wykopie wynosi (1000)\n\nObserwujesz:\n- (${observedEntries}) wpisÃ³w na mikroblogu w tym (${observedEntriesFavourited}) wpisÃ³w â­ Ulubionych\n- (${observedLinks}) znalezisk w tym (${observedLinksFavourited}) znalezisk â­ Ulubionych\n- (${observedLinkComments}) komentarzy w znaleziskach w tym (${observedLinkCommentsFavourited}) komentarzy â­ Ulubionych\n\n> Kliknij [OK] aby kontynuowaÄ‡`), dontDeleteFavourites = confirm(`KROK ${++e}/${o}\nMoÅ¼esz teraz wybraÄ‡ czy chcesz, POMINÄ„Ä† usuwanie dyskusji, ktÃ³re masz oznaczone jako "â­ Ulubione"\n\n> [OK] jeÅ›li chcesz, Å¼eby ğŸŒŸ Ulubione dyskusje NIE ZOSTAÅY USUNIÄ˜TE\n\n> [Anuluj] jeÅ›li CHCESZ USUNÄ„Ä† rÃ³wnieÅ¼ ğŸŒŸ Ulubione dyskusje`); let t = dontDeleteFavourites ? observedEntries - observedEntriesFavourited : observedEntries, s = dontDeleteFavourites ? observedLinks - observedLinksFavourited : observedLinks, i = dontDeleteFavourites ? observedLinkComments - observedLinkCommentsFavourited : observedLinkComments; t > 0 && (deleteEntries = confirm(`KROK ${++e}/${o}\nCzy chcesz usunÄ…Ä‡ (${t}) obserwowanych WPISÃ“W NA MIKROBLOGU?\n\n> [OK] jeÅ›li chcesz, Å¼eby WPISY zostaÅ‚y usuniÄ™te z obserwowanych\n\n> [Anuluj] jeÅ›li nie chcesz usuwaÄ‡ obserwowanych WPISÃ“W`)), s > 0 && (deleteLinks = confirm(`KROK ${++e}/${o}\nCzy chcesz usunÄ…Ä‡ (${s}) obserwowanych ZNALEZISK?\n\n> [OK] jeÅ›li chcesz, Å¼eby ZNALEZISKA zostaÅ‚y usuniÄ™te z obserwowanych\n\n> [Anuluj] jeÅ›li nie chcesz usuwaÄ‡ obserwowanych ZNALEZISK`)), i > 0 && (deleteLinkComments = confirm(`KROK ${++e}/${o}\nCzy chcesz usunÄ…Ä‡ (${i}) obserwowanych KOMENTARZY W ZNALEZISKACH?\n\n> [OK] jeÅ›li chcesz, Å¼eby KOMENTARZE W ZNALEZISKACH zostaÅ‚y usuniÄ™te z obserwowanych\n\n> [Anuluj] jeÅ›li nie chcesz usuwaÄ‡ obserwowanych KOMENTARZY W ZNALEZISKACH`)), deleteEntries || (t = 0), deleteLinks || (s = 0), deleteLinkComments || (i = 0), totalToDelete = t + s + i; let r = `âš  KROK ${++e}/${o}  - USUWANIE âš  \nPo klikniÄ™ciu w [OK] ROZPOCZNIE SIÄ˜ USUWANIE!\n\nWykop X usunie:`; if (t > 0 && (r += `\n- (${t}) obserwowanych wpisÃ³w ${dontDeleteFavourites ? "(bez ulubionych)" : "w tym takÅ¼e ulubione"}`), s > 0 && (r += `\n- (${s}) obserwowanych znalezisk ${dontDeleteFavourites ? "(bez ulubionych)" : "w tym takÅ¼e ulubione"}`), i > 0 && (r += `\n- (${i}) obserwowanych komentarzy w znaleziskach ${dontDeleteFavourites ? "(bez ulubionych)" : "w tym takÅ¼e ulubione"}`), r += `\n\nÅÄ…cznie usuniemy (${totalToDelete}) z (${n.size}) obserwowanych dyskusji.\n\n> [OK] aby USUNÄ„Ä† (${totalToDelete}) obserwowanych dyskusji\n> [Anuluj] aby PRZERWAÄ† proces usuwania.\n`, totalToDelete > 0) confirm(r) && deleteSelectedFromMap(n).then((() => { alert("Wszystkie wybrane dyskusje zostaÅ‚y usuniÄ™te."), window.location.hash = `(ã¥â€¢ï¹â€¢)ã¥__usuniÄ™to_${totalToDelete}_z_${n.size}_obserwowanych_dyskusji` })); else { const e = new URL(window.location.href); e.pathname = "/tag/wykopx", window.history.pushState({}, "", e), window.location.hash = "(ã¥â€¢ï¹â€¢)ã¥", confirm("âš  KROK 21/37 âš \n\n\nNie to nie ( Í¡Â° ÍœÊ– Í¡Â°)") } } })) } console.clear(); const button = document.createElement("button"); button.setAttribute("style", "position: fixed; top: 5px; left: 50%; z-index: 999; display: flex; color: rgb(255 255 255 / 0.6); border: 1px solid rgb(0 0 0 / 0.3); background-color: rgb(0 0 0 / 0.2); padding: 10px;"), button.textContent = "UsuÅ„ obserwowane dyskusje", document.body.insertBefore(button, document.body.firstChild), button.addEventListener("click", (async () => { await wykopx() }));
/* Upewnij siÄ™, Å¼e zaznaczasz i kopiujesz caÅ‚y kod skryptu */